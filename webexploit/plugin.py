import codecs
import os
import json

path = '/home/kali/Desktop/webexploit'
xrayoutpath = path+'/xrayoutput'

filelist = [
    '172.16.109.133:80', 
    '172.16.109.134:80', 
    '172.16.109.135:80', 
    'ptl-0b4ccaf1-1eda6964.libcurl.so', 
    'ptl-8b6d6386-3b4ce735.libcurl.so', 
    'ptl-587f5967-9ed26e17.libcurl.so',
    'ptl-3575c67f-55948aa8.libcurl.so',
    'ptl-b5f276e9-a98bfbc4.libcurl.so',
    'ptl-c36a0d48-2adf1058.libcurl.so',
    'testfire.net',
    'testphp.vulnweb.com'
    ]

pluginlist = []

for fil in filelist:
    fin = codecs.open(os.path.join(xrayoutpath, fil+'.json'), 'r', 'utf-8')
    xrayjson = json.loads(fin.read())
    fin.close()
    for data in xrayjson:
        if data['plugin'] not in pluginlist:
            pluginlist.append(data['plugin'])

    fout = codecs.open(os.path.join(xrayoutpath, 'pluginlist.txt'), 'w', 'utf-8')
    for pul in pluginlist:
        fout.write(str(pul)+'\n')
    fout.close()